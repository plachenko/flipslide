var app=function(){"use strict";function t(){}function e(t){return t()}function i(){return Object.create(null)}function r(t){t.forEach(e)}function n(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t,e){t.appendChild(e)}function o(t,e,i){t.insertBefore(e,i||null)}function h(t){t.parentNode.removeChild(t)}function l(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function c(){return u(" ")}function d(t,e,i,r){return t.addEventListener(e,i,r),()=>t.removeEventListener(e,i,r)}function p(t){return function(e){return e.preventDefault(),t.call(this,e)}}function f(t,e,i){null==i?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function g(t){return""===t?null:+t}function m(t,e){t.value=null==e?"":e}function v(t,e,i,r){t.style.setProperty(e,i,r?"important":"")}let y;function b(t){y=t}function w(){if(!y)throw new Error("Function called outside component initialization");return y}function x(t){w().$$.on_mount.push(t)}function k(){const t=w();return(e,i)=>{const r=t.$$.callbacks[e];if(r){const n=function(t,e,i=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,i,!1,e),r}(e,i);r.slice().forEach((e=>{e.call(t,n)}))}}}function _(t,e){const i=t.$$.callbacks[e.type];i&&i.slice().forEach((t=>t.call(this,e)))}const E=[],$=[],S=[],P=[],B=Promise.resolve();let F=!1;function I(t){S.push(t)}let C=!1;const M=new Set;function A(){if(!C){C=!0;do{for(let t=0;t<E.length;t+=1){const e=E[t];b(e),L(e.$$)}for(b(null),E.length=0;$.length;)$.pop()();for(let t=0;t<S.length;t+=1){const e=S[t];M.has(e)||(M.add(e),e())}S.length=0}while(E.length);for(;P.length;)P.pop()();F=!1,C=!1,M.clear()}}function L(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(I)}}const G=new Set;let T;function z(t,e){t&&t.i&&(G.delete(t),t.i(e))}function j(t,e,i,r){if(t&&t.o){if(G.has(t))return;G.add(t),T.c.push((()=>{G.delete(t),r&&(i&&t.d(1),r())})),t.o(e)}}function q(t){t&&t.c()}function D(t,i,s,a){const{fragment:o,on_mount:h,on_destroy:l,after_update:u}=t.$$;o&&o.m(i,s),a||I((()=>{const i=h.map(e).filter(n);l?l.push(...i):r(i),t.$$.on_mount=[]})),u.forEach(I)}function R(t,e){const i=t.$$;null!==i.fragment&&(r(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function N(t,e){-1===t.$$.dirty[0]&&(E.push(t),F||(F=!0,B.then(A)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function O(e,n,s,a,o,l,u,c=[-1]){const d=y;b(e);const p=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:o,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:n.context||[]),callbacks:i(),dirty:c,skip_bound:!1,root:n.target||d.$$.root};u&&u(p.root);let f=!1;if(p.ctx=s?s(e,n.props||{},((t,i,...r)=>{const n=r.length?r[0]:i;return p.ctx&&o(p.ctx[t],p.ctx[t]=n)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](n),f&&N(e,t)),i})):[],p.update(),f=!0,r(p.before_update),p.fragment=!!a&&a(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(h)}else p.fragment&&p.fragment.c();n.intro&&z(e.$$.fragment),D(e,n.target,n.anchor,n.customElement),A()}b(d)}class U{$destroy(){R(this,1),this.$destroy=t}$on(t,e){const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(e),()=>{const t=i.indexOf(e);-1!==t&&i.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}class H{size=10;angle=0;delta=[0,0];pressure=1;color="#000";x=0;y=0;constructor(t=0,e=0,i){this.x=t,this.y=e,i&&(this.color=i.color,this.delta=i.delta,this.angle=i.angle,this.pressure=i.pressure,this.size=i.size)}offset(t=0,e=0,i){const r=this.x+t,n=this.y+e;return new H(r,n,i)}snap(t,e){const i=e*Math.round(t/e);return t-i<2?i:lSize}}function W(t,e,i){return(1-i)*t+i*e}function Q(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}var Z,X=(function(t,e){t.exports=function t(e,i,r){function n(a,o){if(!i[a]){if(!e[a]){if(!o&&Q)return Q(a);if(s)return s(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var l=i[a]={exports:{}};e[a][0].call(l.exports,(function(t){var i=e[a][1][t];return n(i||t)}),l,l.exports,t,e,i,r)}return i[a].exports}for(var s=Q,a=0;a<r.length;a++)n(r[a]);return n}({1:[function(t,e,i){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function s(t){return"number"==typeof t}function a(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!s(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,i,r,s,h,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var u=new Error('Uncaught, unspecified "error" event. ('+e+")");throw u.context=e,u}if(o(i=this._events[t]))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),i.apply(this,s)}else if(a(i))for(s=Array.prototype.slice.call(arguments,1),r=(l=i.slice()).length,h=0;h<r;h++)l[h].apply(this,s);return!0},r.prototype.addListener=function(t,e){var i;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?a(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,a(this._events[t])&&!this._events[t].warned&&(i=o(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){if(!n(e))throw TypeError("listener must be a function");var i=!1;function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var i,r,s,o;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=(i=this._events[t]).length,r=-1,i===e||n(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(a(i)){for(o=s;o-- >0;)if(i[o]===e||i[o].listener&&i[o].listener===e){r=o;break}if(r<0)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n(i=this._events[t]))this.removeListener(t,i);else if(i)for(;i.length;)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){return this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},{}],2:[function(t,e,i){var r,n,s,a,o;o=navigator.userAgent.toLowerCase(),a=navigator.platform.toLowerCase(),s="ie"===(r=o.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0])[1]&&document.documentMode,(n={name:"version"===r[1]?r[3]:r[1],version:s||parseFloat("opera"===r[1]&&r[4]?r[4]:r[2]),platform:{name:o.match(/ip(?:ad|od|hone)/)?"ios":(o.match(/(?:webos|android)/)||a.match(/mac|win|linux/)||["other"])[0]}})[n.name]=!0,n[n.name+parseInt(n.version,10)]=!0,n.platform[n.platform.name]=!0,e.exports=n},{}],3:[function(t,e,i){var r,n,s,a=function(t,e){for(var i in e)o.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},o={}.hasOwnProperty,h=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1},l=[].slice;r=t("events").EventEmitter,s=t("./browser.coffee"),n=function(t){var e,i;function r(t){var i,r,n;for(r in this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(t),e)n=e[r],null==(i=this.options)[r]&&(i[r]=n)}return a(r,t),e={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},i={delay:500,copy:!1},r.prototype.setOption=function(t,e){if(this.options[t]=e,null!=this._canvas&&("width"===t||"height"===t))return this._canvas[t]=e},r.prototype.setOptions=function(t){var e,i,r;for(e in i=[],t)o.call(t,e)&&(r=t[e],i.push(this.setOption(e,r)));return i},r.prototype.addFrame=function(t,e){var r,n;for(n in null==e&&(e={}),(r={}).transparent=this.options.transparent,i)r[n]=e[n]||i[n];if(null==this.options.width&&this.setOption("width",t.width),null==this.options.height&&this.setOption("height",t.height),"undefined"!=typeof ImageData&&null!==ImageData&&t instanceof ImageData)r.data=t.data;else if("undefined"!=typeof CanvasRenderingContext2D&&null!==CanvasRenderingContext2D&&t instanceof CanvasRenderingContext2D||"undefined"!=typeof WebGLRenderingContext&&null!==WebGLRenderingContext&&t instanceof WebGLRenderingContext)e.copy?r.data=this.getContextData(t):r.context=t;else{if(null==t.childNodes)throw new Error("Invalid image");e.copy?r.data=this.getImageData(t):r.image=t}return this.frames.push(r)},r.prototype.render=function(){var t,e,i;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var t,e,i;for(i=[],t=0,e=this.frames.length;0<=e?t<e:t>e;0<=e?++t:--t)i.push(null);return i}.call(this),e=this.spawnWorkers(),!0===this.options.globalPalette)this.renderNextFrame();else for(t=0,i=e;0<=i?t<i:t>i;0<=i?++t:--t)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},r.prototype.abort=function(){for(var t;null!=(t=this.activeWorkers.shift());)this.log("killing active worker"),t.terminate();return this.running=!1,this.emit("abort")},r.prototype.spawnWorkers=function(){var t,e,i,r;return t=Math.min(this.options.workers,this.frames.length),function(){i=[];for(var r=e=this.freeWorkers.length;e<=t?r<t:r>t;e<=t?r++:r--)i.push(r);return i}.apply(this).forEach((r=this,function(t){var e;return r.log("spawning worker "+t),(e=new Worker(r.options.workerScript)).onmessage=function(t){return r.activeWorkers.splice(r.activeWorkers.indexOf(e),1),r.freeWorkers.push(e),r.frameFinished(t.data)},r.freeWorkers.push(e)})),t},r.prototype.frameFinished=function(t){var e,i;if(this.log("frame "+t.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[t.index]=t,!0===this.options.globalPalette&&(this.options.globalPalette=t.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(e=1,i=this.freeWorkers.length;1<=i?e<i:e>i;1<=i?++e:--e)this.renderNextFrame();return h.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},r.prototype.finishRendering=function(){var t,e,i,r,n,s,a,o,h,l,u,c,d,p,f,g;for(o=0,n=0,h=(p=this.imageParts).length;n<h;n++)o+=((e=p[n]).data.length-1)*e.pageSize+e.cursor;for(o+=e.pageSize-e.cursor,this.log("rendering finished - filesize "+Math.round(o/1e3)+"kb"),t=new Uint8Array(o),c=0,s=0,l=(f=this.imageParts).length;s<l;s++)for(i=a=0,u=(g=(e=f[s]).data).length;a<u;i=++a)d=g[i],t.set(d,c),i===e.data.length-1?c+=e.cursor:c+=e.pageSize;return r=new Blob([t],{type:"image/gif"}),this.emit("finished",r,t)},r.prototype.renderNextFrame=function(){var t,e,i;if(0===this.freeWorkers.length)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return t=this.frames[this.nextFrame++],i=this.freeWorkers.shift(),e=this.getTask(t),this.log("starting frame "+(e.index+1)+" of "+this.frames.length),this.activeWorkers.push(i),i.postMessage(e)},r.prototype.getContextData=function(t){return t.getImageData(0,0,this.options.width,this.options.height).data},r.prototype.getImageData=function(t){var e;return null==this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),(e=this._canvas.getContext("2d")).setFill=this.options.background,e.fillRect(0,0,this.options.width,this.options.height),e.drawImage(t,0,0),this.getContextData(e)},r.prototype.getTask=function(t){var e,i;if(i={index:e=this.frames.indexOf(t),last:e===this.frames.length-1,delay:t.delay,transparent:t.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:"chrome"===s.name},null!=t.data)i.data=t.data;else if(null!=t.context)i.data=this.getContextData(t.context);else{if(null==t.image)throw new Error("Invalid frame");i.data=this.getImageData(t.image)}return i},r.prototype.log=function(){var t;if(t=1<=arguments.length?l.call(arguments,0):[],this.options.debug)return console.log.apply(console,t)},r}(r),e.exports=n},{"./browser.coffee":2,events:1}]},{},[3])(3)}(Z={exports:{}},Z.exports),Z.exports);const V=[];for(let t=0;t<256;t++)V[t]=(t<16?"0":"")+t.toString(16);function Y(t,e,i){return Math.max(e,Math.min(i,t))}function J(t,e,i){return(1-i)*t+i*e}const K={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},tt={h:0,s:0,l:0},et={h:0,s:0,l:0};function it(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}function rt(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function nt(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class st{constructor(t,e,i){return void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,i){return this.r=t,this.g=e,this.b=i,this}setHSL(t,e,i){var r;if(t=(t%(r=1)+r)%r,e=Y(e,0,1),i=Y(i,0,1),0===e)this.r=this.g=this.b=i;else{const r=i<=.5?i*(1+e):i+e-i*e,n=2*i-r;this.r=it(n,r,t+1/3),this.g=it(n,r,t),this.b=it(n,r,t-1/3)}return this}setStyle(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const r=i[1],n=i[2];switch(r){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(n))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,e(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(n))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,e(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(n)){const i=parseFloat(t[1])/360,r=parseInt(t[2],10)/100,n=parseInt(t[3],10)/100;return e(t[4]),this.setHSL(i,r,n)}}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=i[1],e=t.length;if(3===e)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=K[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,e=2){return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this}copyLinearToGamma(t,e=2){const i=e>0?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=rt(t.r),this.g=rt(t.g),this.b=rt(t.b),this}copyLinearToSRGB(t){return this.r=nt(t.r),this.g=nt(t.g),this.b=nt(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return"#"+("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const e=this.r,i=this.g,r=this.b,n=Math.max(e,i,r),s=Math.min(e,i,r);let a,o;const h=(s+n)/2;if(s===n)a=0,o=0;else{const t=n-s;switch(o=h<=.5?t/(n+s):t/(2-n-s),n){case e:a=(i-r)/t+(i<r?6:0);break;case i:a=(r-e)/t+2;break;case r:a=(e-i)/t+4}a/=6}return t.h=a,t.s=o,t.l=h,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,i){return this.getHSL(tt),tt.h+=t,tt.s+=e,tt.l+=i,this.setHSL(tt.h,tt.s,tt.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,i){return this.r=t.r+(e.r-t.r)*i,this.g=t.g+(e.g-t.g)*i,this.b=t.b+(e.b-t.b)*i,this}lerpHSL(t,e){this.getHSL(tt),t.getHSL(et);const i=J(tt.h,et.h,e),r=J(tt.s,et.s,e),n=J(tt.l,et.l,e);return this.setHSL(i,r,n),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}function at(e){let i;return{c(){i=l("canvas")},m(t,r){o(t,i,r),e[16](i)},p:t,i:t,o:t,d(t){t&&h(i),e[16](null)}}}function ot(t,e,i){let r,n,s,{strokeArray:a=[]}=e,{iSize:o=2}=e,{color:h="#000"}=e,{opacity:l=1}=e,{width:u=0}=e,{height:c=0}=e,{currentPoint:d=null}=e,{recording:p=!0}=e,f=k(),g=[];let{frameIdx:m=0}=e,{frameSkip:v=3}=e,y=[],{frameEnd:b=10}=e;function w(){s||(s=d),g.push(d);let t,e=d.x-s.x,r=d.y-s.y,n=Math.atan2(r,e);e&&Math.abs(e)>=Math.abs(r)?t=Math.abs(Math.round(e)):r&&Math.abs(r)>=Math.abs(e)&&(t=Math.abs(Math.round(r)));let a=new st(h).getHexString();i(1,d.angle=n+function(t){return t*(Math.PI/180)}(45),d),i(1,d.size=o/3+(t/3+4*d.pressure),d),i(1,d.color=a,d),_(d,s),p&&f("frameChange",d),s=d}function _(t,e){let i=0,r=e.x-t.x,n=e.y-t.y;i=Math.abs(r)>Math.abs(n)?Math.abs(r):Math.abs(n);for(let r=0;r<=i;r++){let n=W(t.x,e.x,r/i),s=W(t.y,e.y,r/i);const a=new H(n,s);a.pressure=W(t.pressure,e.pressure,r/i),a.size=W(t.size,e.size,r/i),a.delta[0]=W(t.delta[0],e.delta[0],r/i)/o,a.delta[1]=W(t.delta[1],e.delta[1],r/i)/o,a.angle=W(t.angle,e.angle,r/i),a.color=t.color,E(a,a.size,a.angle,a.color)}}function E(t,e,i=0,r=!1,s){const a=[];let o=new H(t.x,t.y,t.options);r||n.fillRect(o.x-2,o.y-2,4,4),a[0]=null==o?void 0:o.offset(e,-e),a[1]=null==o?void 0:o.offset(-e,-e),a[2]=null==o?void 0:o.offset(-e,e),a[3]=null==o?void 0:o.offset(e,e),a.forEach((t=>{!function(t,e=0,i=new H){let r=e,n=Math.sin(r),s=Math.cos(r);t.x-=i.x,t.y-=i.y;let a=t.x*s-t.y*n,o=t.x*n+t.y*s;t.x=a+i.x,t.y=o+i.y}(t,i,o)})),function(t,e=1,i=!1,r=!1){var s,a,o,h;let l=t.length;for(n.beginPath(),n.moveTo(null===(s=t[0])||void 0===s?void 0:s.x,null===(a=t[0])||void 0===a?void 0:a.y);0<l;){const r=t.length-l;n.lineTo(null===(o=t[r])||void 0===o?void 0:o.x,null===(h=t[r])||void 0===h?void 0:h.y),0!=r||i||n.closePath(),l-=Math.abs(e)}i&&n.closePath(),r&&(n.fillStyle=r,n.fill())}(a,1,!0,r)}function S(t=m){var e;P(),n.fillStyle="#FFF",n.fillRect(0,0,r.width,r.height),null===(e=y[t])||void 0===e||e.forEach((t=>{t.forEach(((e,i)=>{_(e,i?t[i-1]:t[0])}))}))}function P(){i(2,a=[]),n.clearRect(0,0,r.width,r.height)}return x((()=>{!function(t=window.innerWidth,e=window.innerHeight){i(0,r.width=t,r),i(0,r.height=e,r),n=r.getContext("2d")}()})),t.$$set=t=>{"strokeArray"in t&&i(2,a=t.strokeArray),"iSize"in t&&i(3,o=t.iSize),"color"in t&&i(4,h=t.color),"opacity"in t&&i(5,l=t.opacity),"width"in t&&i(6,u=t.width),"height"in t&&i(7,c=t.height),"currentPoint"in t&&i(1,d=t.currentPoint),"recording"in t&&i(8,p=t.recording),"frameIdx"in t&&i(9,m=t.frameIdx),"frameSkip"in t&&i(10,v=t.frameSkip),"frameEnd"in t&&i(11,b=t.frameEnd)},t.$$.update=()=>{2&t.$$.dirty[0]&&d&&w(),512&t.$$.dirty[0]&&m&&S(),t.$$.dirty[0]},[r,d,a,o,h,l,u,c,p,m,v,b,function(){y[m]||(y[m]=[]),y[m].push(g),s=null,g=[]},P,function(){const t=new Blob(['(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module \'"+o+"\'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){var NeuQuant=require("./TypedNeuQuant.js");var LZWEncoder=require("./LZWEncoder.js");function ByteArray(){this.page=-1;this.pages=[];this.newPage()}ByteArray.pageSize=4096;ByteArray.charMap={};for(var i=0;i<256;i++)ByteArray.charMap[i]=String.fromCharCode(i);ByteArray.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(ByteArray.pageSize);this.cursor=0};ByteArray.prototype.getData=function(){var rv="";for(var p=0;p<this.pages.length;p++){for(var i=0;i<ByteArray.pageSize;i++){rv+=ByteArray.charMap[this.pages[p][i]]}}return rv};ByteArray.prototype.writeByte=function(val){if(this.cursor>=ByteArray.pageSize)this.newPage();this.pages[this.page][this.cursor++]=val};ByteArray.prototype.writeUTFBytes=function(string){for(var l=string.length,i=0;i<l;i++)this.writeByte(string.charCodeAt(i))};ByteArray.prototype.writeBytes=function(array,offset,length){for(var l=length||array.length,i=offset||0;i<l;i++)this.writeByte(array[i])};function GIFEncoder(width,height){this.width=~~width;this.height=~~height;this.transparent=null;this.transIndex=0;this.repeat=-1;this.delay=0;this.image=null;this.pixels=null;this.indexedPixels=null;this.colorDepth=null;this.colorTab=null;this.neuQuant=null;this.usedEntry=new Array;this.palSize=7;this.dispose=-1;this.firstFrame=true;this.sample=10;this.dither=false;this.globalPalette=false;this.out=new ByteArray}GIFEncoder.prototype.setDelay=function(milliseconds){this.delay=Math.round(milliseconds/10)};GIFEncoder.prototype.setFrameRate=function(fps){this.delay=Math.round(100/fps)};GIFEncoder.prototype.setDispose=function(disposalCode){if(disposalCode>=0)this.dispose=disposalCode};GIFEncoder.prototype.setRepeat=function(repeat){this.repeat=repeat};GIFEncoder.prototype.setTransparent=function(color){this.transparent=color};GIFEncoder.prototype.addFrame=function(imageData){this.image=imageData;this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null;this.getImagePixels();this.analyzePixels();if(this.globalPalette===true)this.globalPalette=this.colorTab;if(this.firstFrame){this.writeLSD();this.writePalette();if(this.repeat>=0){this.writeNetscapeExt()}}this.writeGraphicCtrlExt();this.writeImageDesc();if(!this.firstFrame&&!this.globalPalette)this.writePalette();this.writePixels();this.firstFrame=false};GIFEncoder.prototype.finish=function(){this.out.writeByte(59)};GIFEncoder.prototype.setQuality=function(quality){if(quality<1)quality=1;this.sample=quality};GIFEncoder.prototype.setDither=function(dither){if(dither===true)dither="FloydSteinberg";this.dither=dither};GIFEncoder.prototype.setGlobalPalette=function(palette){this.globalPalette=palette};GIFEncoder.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette};GIFEncoder.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")};GIFEncoder.prototype.analyzePixels=function(){if(!this.colorTab){this.neuQuant=new NeuQuant(this.pixels,this.sample);this.neuQuant.buildColormap();this.colorTab=this.neuQuant.getColormap()}if(this.dither){this.ditherPixels(this.dither.replace("-serpentine",""),this.dither.match(/-serpentine/)!==null)}else{this.indexPixels()}this.pixels=null;this.colorDepth=8;this.palSize=7;if(this.transparent!==null){this.transIndex=this.findClosest(this.transparent,true)}};GIFEncoder.prototype.indexPixels=function(imgq){var nPix=this.pixels.length/3;this.indexedPixels=new Uint8Array(nPix);var k=0;for(var j=0;j<nPix;j++){var index=this.findClosestRGB(this.pixels[k++]&255,this.pixels[k++]&255,this.pixels[k++]&255);this.usedEntry[index]=true;this.indexedPixels[j]=index}};GIFEncoder.prototype.ditherPixels=function(kernel,serpentine){var kernels={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!kernel||!kernels[kernel]){throw"Unknown dithering kernel: "+kernel}var ds=kernels[kernel];var index=0,height=this.height,width=this.width,data=this.pixels;var direction=serpentine?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var y=0;y<height;y++){if(serpentine)direction=direction*-1;for(var x=direction==1?0:width-1,xend=direction==1?width:0;x!==xend;x+=direction){index=y*width+x;var idx=index*3;var r1=data[idx];var g1=data[idx+1];var b1=data[idx+2];idx=this.findClosestRGB(r1,g1,b1);this.usedEntry[idx]=true;this.indexedPixels[index]=idx;idx*=3;var r2=this.colorTab[idx];var g2=this.colorTab[idx+1];var b2=this.colorTab[idx+2];var er=r1-r2;var eg=g1-g2;var eb=b1-b2;for(var i=direction==1?0:ds.length-1,end=direction==1?ds.length:0;i!==end;i+=direction){var x1=ds[i][1];var y1=ds[i][2];if(x1+x>=0&&x1+x<width&&y1+y>=0&&y1+y<height){var d=ds[i][0];idx=index+x1+y1*width;idx*=3;data[idx]=Math.max(0,Math.min(255,data[idx]+er*d));data[idx+1]=Math.max(0,Math.min(255,data[idx+1]+eg*d));data[idx+2]=Math.max(0,Math.min(255,data[idx+2]+eb*d))}}}}};GIFEncoder.prototype.findClosest=function(c,used){return this.findClosestRGB((c&16711680)>>16,(c&65280)>>8,c&255,used)};GIFEncoder.prototype.findClosestRGB=function(r,g,b,used){if(this.colorTab===null)return-1;if(this.neuQuant&&!used){return this.neuQuant.lookupRGB(r,g,b)}var c=b|g<<8|r<<16;var minpos=0;var dmin=256*256*256;var len=this.colorTab.length;for(var i=0,index=0;i<len;index++){var dr=r-(this.colorTab[i++]&255);var dg=g-(this.colorTab[i++]&255);var db=b-(this.colorTab[i++]&255);var d=dr*dr+dg*dg+db*db;if((!used||this.usedEntry[index])&&d<dmin){dmin=d;minpos=index}}return minpos};GIFEncoder.prototype.getImagePixels=function(){var w=this.width;var h=this.height;this.pixels=new Uint8Array(w*h*3);var data=this.image;var srcPos=0;var count=0;for(var i=0;i<h;i++){for(var j=0;j<w;j++){this.pixels[count++]=data[srcPos++];this.pixels[count++]=data[srcPos++];this.pixels[count++]=data[srcPos++];srcPos++}}};GIFEncoder.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33);this.out.writeByte(249);this.out.writeByte(4);var transp,disp;if(this.transparent===null){transp=0;disp=0}else{transp=1;disp=2}if(this.dispose>=0){disp=dispose&7}disp<<=2;this.out.writeByte(0|disp|0|transp);this.writeShort(this.delay);this.out.writeByte(this.transIndex);this.out.writeByte(0)};GIFEncoder.prototype.writeImageDesc=function(){this.out.writeByte(44);this.writeShort(0);this.writeShort(0);this.writeShort(this.width);this.writeShort(this.height);if(this.firstFrame||this.globalPalette){this.out.writeByte(0)}else{this.out.writeByte(128|0|0|0|this.palSize)}};GIFEncoder.prototype.writeLSD=function(){this.writeShort(this.width);this.writeShort(this.height);this.out.writeByte(128|112|0|this.palSize);this.out.writeByte(0);this.out.writeByte(0)};GIFEncoder.prototype.writeNetscapeExt=function(){this.out.writeByte(33);this.out.writeByte(255);this.out.writeByte(11);this.out.writeUTFBytes("NETSCAPE2.0");this.out.writeByte(3);this.out.writeByte(1);this.writeShort(this.repeat);this.out.writeByte(0)};GIFEncoder.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);var n=3*256-this.colorTab.length;for(var i=0;i<n;i++)this.out.writeByte(0)};GIFEncoder.prototype.writeShort=function(pValue){this.out.writeByte(pValue&255);this.out.writeByte(pValue>>8&255)};GIFEncoder.prototype.writePixels=function(){var enc=new LZWEncoder(this.width,this.height,this.indexedPixels,this.colorDepth);enc.encode(this.out)};GIFEncoder.prototype.stream=function(){return this.out};module.exports=GIFEncoder},{"./LZWEncoder.js":2,"./TypedNeuQuant.js":3}],2:[function(require,module,exports){var EOF=-1;var BITS=12;var HSIZE=5003;var masks=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function LZWEncoder(width,height,pixels,colorDepth){var initCodeSize=Math.max(2,colorDepth);var accum=new Uint8Array(256);var htab=new Int32Array(HSIZE);var codetab=new Int32Array(HSIZE);var cur_accum,cur_bits=0;var a_count;var free_ent=0;var maxcode;var clear_flg=false;var g_init_bits,ClearCode,EOFCode;function char_out(c,outs){accum[a_count++]=c;if(a_count>=254)flush_char(outs)}function cl_block(outs){cl_hash(HSIZE);free_ent=ClearCode+2;clear_flg=true;output(ClearCode,outs)}function cl_hash(hsize){for(var i=0;i<hsize;++i)htab[i]=-1}function compress(init_bits,outs){var fcode,c,i,ent,disp,hsize_reg,hshift;g_init_bits=init_bits;clear_flg=false;n_bits=g_init_bits;maxcode=MAXCODE(n_bits);ClearCode=1<<init_bits-1;EOFCode=ClearCode+1;free_ent=ClearCode+2;a_count=0;ent=nextPixel();hshift=0;for(fcode=HSIZE;fcode<65536;fcode*=2)++hshift;hshift=8-hshift;hsize_reg=HSIZE;cl_hash(hsize_reg);output(ClearCode,outs);outer_loop:while((c=nextPixel())!=EOF){fcode=(c<<BITS)+ent;i=c<<hshift^ent;if(htab[i]===fcode){ent=codetab[i];continue}else if(htab[i]>=0){disp=hsize_reg-i;if(i===0)disp=1;do{if((i-=disp)<0)i+=hsize_reg;if(htab[i]===fcode){ent=codetab[i];continue outer_loop}}while(htab[i]>=0)}output(ent,outs);ent=c;if(free_ent<1<<BITS){codetab[i]=free_ent++;htab[i]=fcode}else{cl_block(outs)}}output(ent,outs);output(EOFCode,outs)}function encode(outs){outs.writeByte(initCodeSize);remaining=width*height;curPixel=0;compress(initCodeSize+1,outs);outs.writeByte(0)}function flush_char(outs){if(a_count>0){outs.writeByte(a_count);outs.writeBytes(accum,0,a_count);a_count=0}}function MAXCODE(n_bits){return(1<<n_bits)-1}function nextPixel(){if(remaining===0)return EOF;--remaining;var pix=pixels[curPixel++];return pix&255}function output(code,outs){cur_accum&=masks[cur_bits];if(cur_bits>0)cur_accum|=code<<cur_bits;else cur_accum=code;cur_bits+=n_bits;while(cur_bits>=8){char_out(cur_accum&255,outs);cur_accum>>=8;cur_bits-=8}if(free_ent>maxcode||clear_flg){if(clear_flg){maxcode=MAXCODE(n_bits=g_init_bits);clear_flg=false}else{++n_bits;if(n_bits==BITS)maxcode=1<<BITS;else maxcode=MAXCODE(n_bits)}}if(code==EOFCode){while(cur_bits>0){char_out(cur_accum&255,outs);cur_accum>>=8;cur_bits-=8}flush_char(outs)}}this.encode=encode}module.exports=LZWEncoder},{}],3:[function(require,module,exports){var ncycles=100;var netsize=256;var maxnetpos=netsize-1;var netbiasshift=4;var intbiasshift=16;var intbias=1<<intbiasshift;var gammashift=10;var gamma=1<<gammashift;var betashift=10;var beta=intbias>>betashift;var betagamma=intbias<<gammashift-betashift;var initrad=netsize>>3;var radiusbiasshift=6;var radiusbias=1<<radiusbiasshift;var initradius=initrad*radiusbias;var radiusdec=30;var alphabiasshift=10;var initalpha=1<<alphabiasshift;var alphadec;var radbiasshift=8;var radbias=1<<radbiasshift;var alpharadbshift=alphabiasshift+radbiasshift;var alpharadbias=1<<alpharadbshift;var prime1=499;var prime2=491;var prime3=487;var prime4=503;var minpicturebytes=3*prime4;function NeuQuant(pixels,samplefac){var network;var netindex;var bias;var freq;var radpower;function init(){network=[];netindex=new Int32Array(256);bias=new Int32Array(netsize);freq=new Int32Array(netsize);radpower=new Int32Array(netsize>>3);var i,v;for(i=0;i<netsize;i++){v=(i<<netbiasshift+8)/netsize;network[i]=new Float64Array([v,v,v,0]);freq[i]=intbias/netsize;bias[i]=0}}function unbiasnet(){for(var i=0;i<netsize;i++){network[i][0]>>=netbiasshift;network[i][1]>>=netbiasshift;network[i][2]>>=netbiasshift;network[i][3]=i}}function altersingle(alpha,i,b,g,r){network[i][0]-=alpha*(network[i][0]-b)/initalpha;network[i][1]-=alpha*(network[i][1]-g)/initalpha;network[i][2]-=alpha*(network[i][2]-r)/initalpha}function alterneigh(radius,i,b,g,r){var lo=Math.abs(i-radius);var hi=Math.min(i+radius,netsize);var j=i+1;var k=i-1;var m=1;var p,a;while(j<hi||k>lo){a=radpower[m++];if(j<hi){p=network[j++];p[0]-=a*(p[0]-b)/alpharadbias;p[1]-=a*(p[1]-g)/alpharadbias;p[2]-=a*(p[2]-r)/alpharadbias}if(k>lo){p=network[k--];p[0]-=a*(p[0]-b)/alpharadbias;p[1]-=a*(p[1]-g)/alpharadbias;p[2]-=a*(p[2]-r)/alpharadbias}}}function contest(b,g,r){var bestd=~(1<<31);var bestbiasd=bestd;var bestpos=-1;var bestbiaspos=bestpos;var i,n,dist,biasdist,betafreq;for(i=0;i<netsize;i++){n=network[i];dist=Math.abs(n[0]-b)+Math.abs(n[1]-g)+Math.abs(n[2]-r);if(dist<bestd){bestd=dist;bestpos=i}biasdist=dist-(bias[i]>>intbiasshift-netbiasshift);if(biasdist<bestbiasd){bestbiasd=biasdist;bestbiaspos=i}betafreq=freq[i]>>betashift;freq[i]-=betafreq;bias[i]+=betafreq<<gammashift}freq[bestpos]+=beta;bias[bestpos]-=betagamma;return bestbiaspos}function inxbuild(){var i,j,p,q,smallpos,smallval,previouscol=0,startpos=0;for(i=0;i<netsize;i++){p=network[i];smallpos=i;smallval=p[1];for(j=i+1;j<netsize;j++){q=network[j];if(q[1]<smallval){smallpos=j;smallval=q[1]}}q=network[smallpos];if(i!=smallpos){j=q[0];q[0]=p[0];p[0]=j;j=q[1];q[1]=p[1];p[1]=j;j=q[2];q[2]=p[2];p[2]=j;j=q[3];q[3]=p[3];p[3]=j}if(smallval!=previouscol){netindex[previouscol]=startpos+i>>1;for(j=previouscol+1;j<smallval;j++)netindex[j]=i;previouscol=smallval;startpos=i}}netindex[previouscol]=startpos+maxnetpos>>1;for(j=previouscol+1;j<256;j++)netindex[j]=maxnetpos}function inxsearch(b,g,r){var a,p,dist;var bestd=1e3;var best=-1;var i=netindex[g];var j=i-1;while(i<netsize||j>=0){if(i<netsize){p=network[i];dist=p[1]-g;if(dist>=bestd)i=netsize;else{i++;if(dist<0)dist=-dist;a=p[0]-b;if(a<0)a=-a;dist+=a;if(dist<bestd){a=p[2]-r;if(a<0)a=-a;dist+=a;if(dist<bestd){bestd=dist;best=p[3]}}}}if(j>=0){p=network[j];dist=g-p[1];if(dist>=bestd)j=-1;else{j--;if(dist<0)dist=-dist;a=p[0]-b;if(a<0)a=-a;dist+=a;if(dist<bestd){a=p[2]-r;if(a<0)a=-a;dist+=a;if(dist<bestd){bestd=dist;best=p[3]}}}}}return best}function learn(){var i;var lengthcount=pixels.length;var alphadec=30+(samplefac-1)/3;var samplepixels=lengthcount/(3*samplefac);var delta=~~(samplepixels/ncycles);var alpha=initalpha;var radius=initradius;var rad=radius>>radiusbiasshift;if(rad<=1)rad=0;for(i=0;i<rad;i++)radpower[i]=alpha*((rad*rad-i*i)*radbias/(rad*rad));var step;if(lengthcount<minpicturebytes){samplefac=1;step=3}else if(lengthcount%prime1!==0){step=3*prime1}else if(lengthcount%prime2!==0){step=3*prime2}else if(lengthcount%prime3!==0){step=3*prime3}else{step=3*prime4}var b,g,r,j;var pix=0;i=0;while(i<samplepixels){b=(pixels[pix]&255)<<netbiasshift;g=(pixels[pix+1]&255)<<netbiasshift;r=(pixels[pix+2]&255)<<netbiasshift;j=contest(b,g,r);altersingle(alpha,j,b,g,r);if(rad!==0)alterneigh(rad,j,b,g,r);pix+=step;if(pix>=lengthcount)pix-=lengthcount;i++;if(delta===0)delta=1;if(i%delta===0){alpha-=alpha/alphadec;radius-=radius/radiusdec;rad=radius>>radiusbiasshift;if(rad<=1)rad=0;for(j=0;j<rad;j++)radpower[j]=alpha*((rad*rad-j*j)*radbias/(rad*rad))}}}function buildColormap(){init();learn();unbiasnet();inxbuild()}this.buildColormap=buildColormap;function getColormap(){var map=[];var index=[];for(var i=0;i<netsize;i++)index[network[i][3]]=i;var k=0;for(var l=0;l<netsize;l++){var j=index[l];map[k++]=network[j][0];map[k++]=network[j][1];map[k++]=network[j][2]}return map}this.getColormap=getColormap;this.lookupRGB=inxsearch}module.exports=NeuQuant},{}],4:[function(require,module,exports){var GIFEncoder,renderFrame;GIFEncoder=require("./GIFEncoder.js");renderFrame=function(frame){var encoder,page,stream,transfer;encoder=new GIFEncoder(frame.width,frame.height);if(frame.index===0){encoder.writeHeader()}else{encoder.firstFrame=false}encoder.setTransparent(frame.transparent);encoder.setRepeat(frame.repeat);encoder.setDelay(frame.delay);encoder.setQuality(frame.quality);encoder.setDither(frame.dither);encoder.setGlobalPalette(frame.globalPalette);encoder.addFrame(frame.data);if(frame.last){encoder.finish()}if(frame.globalPalette===true){frame.globalPalette=encoder.getGlobalPalette()}stream=encoder.stream();frame.data=stream.pages;frame.cursor=stream.cursor;frame.pageSize=stream.constructor.pageSize;if(frame.canTransfer){transfer=function(){var i,len,ref,results;ref=frame.data;results=[];for(i=0,len=ref.length;i<len;i++){page=ref[i];results.push(page.buffer)}return results}();return self.postMessage(frame,transfer)}else{return self.postMessage(frame)}};self.onmessage=function(event){return renderFrame(event.data)}},{"./GIFEncoder.js":1}]},{},[4]);'],{type:"application/javascript"});let e=URL.createObjectURL(t);const i=new X({workers:4,width:r.width,height:r.height,workerScript:e,quality:3});for(let t=1;t<=b;t++)S(t),i.addFrame(n,{copy:!0,delay:.01});i.render(),i.on("finished",(function(t){window.open(URL.createObjectURL(t))}))},function(){const t=r.toDataURL("image/png");let e;fetch(t).then((t=>t.blob())).then((t=>{e=URL.createObjectURL(t),window.open(e)}))},function(t){$[t?"unshift":"push"]((()=>{r=t,i(0,r)}))}]}st.NAMES=K,st.prototype.isColor=!0,st.prototype.r=1,st.prototype.g=1,st.prototype.b=1;class ht extends U{constructor(t){super(),O(this,t,ot,at,s,{strokeArray:2,iSize:3,color:4,opacity:5,width:6,height:7,currentPoint:1,recording:8,frameIdx:9,frameSkip:10,frameEnd:11,endStroke:12,clear:13,saveGIF:14,savePNG:15},null,[-1,-1])}get strokeArray(){return this.$$.ctx[2]}set strokeArray(t){this.$$set({strokeArray:t}),A()}get iSize(){return this.$$.ctx[3]}set iSize(t){this.$$set({iSize:t}),A()}get color(){return this.$$.ctx[4]}set color(t){this.$$set({color:t}),A()}get opacity(){return this.$$.ctx[5]}set opacity(t){this.$$set({opacity:t}),A()}get width(){return this.$$.ctx[6]}set width(t){this.$$set({width:t}),A()}get height(){return this.$$.ctx[7]}set height(t){this.$$set({height:t}),A()}get currentPoint(){return this.$$.ctx[1]}set currentPoint(t){this.$$set({currentPoint:t}),A()}get recording(){return this.$$.ctx[8]}set recording(t){this.$$set({recording:t}),A()}get frameIdx(){return this.$$.ctx[9]}set frameIdx(t){this.$$set({frameIdx:t}),A()}get frameSkip(){return this.$$.ctx[10]}set frameSkip(t){this.$$set({frameSkip:t}),A()}get frameEnd(){return this.$$.ctx[11]}set frameEnd(t){this.$$set({frameEnd:t}),A()}get endStroke(){return this.$$.ctx[12]}get clear(){return this.$$.ctx[13]}get saveGIF(){return this.$$.ctx[14]}get savePNG(){return this.$$.ctx[15]}}function lt(e){let i,n,s;return{c(){i=l("div"),f(i,"id","capture"),f(i,"class","svelte-11ujypm")},m(t,r){o(t,i,r),e[3](i),n||(s=[d(i,"contextmenu",p(e[2])),d(i,"pointermove",e[1]),d(i,"pointerdown",e[1]),d(i,"pointerup",e[1])],n=!0)},p:t,i:t,o:t,d(t){t&&h(i),e[3](null),n=!1,r(s)}}}function ut(t,e,i){let r,n=!1;const s=k();return[r,function(t){const e=new H(t.clientX,t.clientY);t.pressure?(n||(n=!0,s("capStart")),e.pressure=t.pressure,e.dx=t.movementX,e.dy=t.movementY,s("capEvt",e)):(n&&(s("capDone"),n=!1),s("mvEvt",e))},function(e){_.call(this,t,e)},function(t){$[t?"unshift":"push"]((()=>{r=t,i(0,r)}))}]}class ct extends U{constructor(t){super(),O(this,t,ut,lt,s,{})}}function dt(e){let i,n,s,u,p,g,m,v;return{c(){i=l("div"),n=l("div"),n.textContent="save png",s=c(),u=l("div"),u.textContent="save gif",p=c(),g=l("div"),g.textContent="flipslide",f(n,"class","btn svelte-1fqm2a8"),f(u,"class","btn svelte-1fqm2a8"),f(g,"class","btn svelte-1fqm2a8"),f(g,"id","logo"),f(i,"id","flipslide-logo"),f(i,"draggable","true"),f(i,"class","svelte-1fqm2a8")},m(t,r){o(t,i,r),a(i,n),a(i,s),a(i,u),a(i,p),a(i,g),e[3](i),m||(v=[d(n,"click",e[2]),d(u,"click",e[1])],m=!0)},p:t,i:t,o:t,d(t){t&&h(i),e[3](null),m=!1,r(v)}}}function pt(t,e,i){const r=k();let n;function s(t=null,e=null){let r={x:window.innerWidth/2-n.getBoundingClientRect().width/2,y:window.innerHeight};e=e||r,i(0,n.style.left=`${e.x}px`,n)}return x((()=>{s(),window.addEventListener("resize",s),n.addEventListener("opointerdown",(t=>{console.log(t)})),n.addEventListener("ondragstart",(t=>{console.log(t)})),n.addEventListener("ondragged",(t=>{console.log(t)}))})),[n,function(){r("handleSave",{type:"gif"})},function(){r("handleSave",{type:"png"})},function(t){$[t?"unshift":"push"]((()=>{n=t,i(0,n)}))}]}class ft extends U{constructor(t){super(),O(this,t,pt,dt,s,{})}}function gt(t,e,i){const r=t.slice();return r[36]=e[i],r[37]=e,r[38]=i,r}function mt(t){let e;return{c(){e=u("stop")},m(t,i){o(t,e,i)},d(t){t&&h(e)}}}function vt(t){let e;return{c(){e=u("play")},m(t,i){o(t,e,i)},d(t){t&&h(e)}}}function yt(t){let e;return{c(){e=u("recording...")},m(t,i){o(t,e,i)},d(t){t&&h(e)}}}function bt(t){let e;return{c(){e=u("record")},m(t,i){o(t,e,i)},d(t){t&&h(e)}}}function wt(t){let e,i,r,n;function s(t,e){return t[3]?xt:kt}let c=s(t),p=c(t);return{c(){e=l("a"),i=u("autoReset: \r\n\t\t\t\t"),p.c(),f(e,"class","btn"),f(e,"href","#")},m(s,h){o(s,e,h),a(e,i),p.m(e,null),r||(n=d(e,"click",t[16]),r=!0)},p(t,i){c!==(c=s(t))&&(p.d(1),p=c(t),p&&(p.c(),p.m(e,null)))},d(t){t&&h(e),p.d(),r=!1,n()}}}function xt(t){let e;return{c(){e=u("on")},m(t,i){o(t,e,i)},d(t){t&&h(e)}}}function kt(t){let e;return{c(){e=u("off")},m(t,i){o(t,e,i)},d(t){t&&h(e)}}}function _t(t){let e,i,r=t[37],n=t[38];const s=()=>t[28](e,r,n),a=()=>t[28](null,r,n);return e=new ht({props:{}}),s(),e.$on("frameChange",t[21]),{c(){q(e.$$.fragment)},m(t,r){D(e,t,r),i=!0},p(t,i){r===t[37]&&n===t[38]||(a(),r=t[37],n=t[38],s());e.$set({})},i(t){i||(z(e.$$.fragment,t),i=!0)},o(t){j(e.$$.fragment,t),i=!1},d(t){a(),R(e,t)}}}function Et(t){let e,i,n,s,p,y,b,w,x,k,_,E,$,S,P,B,F,I,C,M,A,L,G,N,O,U,H,W,Q,Z,X,V;function Y(t,e){return t[6]?mt:vt}let J=Y(t),K=J(t);function tt(t,e){return t[7]?yt:bt}let et=tt(t),it=et(t),rt=t[7]&&wt(t);U=new ct({}),U.$on("capEvt",t[10]),U.$on("mvEvt",St),U.$on("capStart",$t),U.$on("capDone",t[11]);let nt=t[9],st=[];for(let e=0;e<nt.length;e+=1)st[e]=_t(gt(t,nt,e));const at=t=>j(st[t],1,1,(()=>{st[t]=null}));return Q=new ft({props:{}}),t[29](Q),Q.$on("handleSave",t[12]),{c(){e=l("main"),i=l("div"),n=l("a"),K.c(),s=c(),p=l("input"),y=c(),b=l("span"),w=u("frame: \r\n\t\t\t"),x=l("input"),k=c(),_=l("input"),E=c(),$=l("input"),S=c(),P=l("a"),it.c(),B=c(),rt&&rt.c(),F=c(),I=l("div"),C=l("input"),M=c(),A=l("div"),L=l("input"),G=c(),N=l("input"),O=c(),q(U.$$.fragment),H=c();for(let t=0;t<st.length;t+=1)st[t].c();W=c(),q(Q.$$.fragment),f(n,"class","btn"),f(n,"href","#"),f(p,"type","range"),f(p,"min","1"),f(p,"max",t[4]),f(x,"max",t[4]),f(x,"min","1"),v(x,"width","60px"),f(x,"type","number"),f(_,"type","range"),f(_,"min","1"),f(_,"max","10"),v(_,"width","40px"),f($,"type","number"),v($,"width","60px"),f(P,"class","btn"),f(P,"href","#"),v(i,"z-index","9999"),v(i,"position","absolute"),f(C,"type","range"),f(C,"class","svelte-1qv8711"),f(I,"id","brushSize"),f(I,"class","menu vert svelte-1qv8711"),f(L,"min","0"),f(L,"max","1"),f(L,"step",".1"),f(L,"type","range"),f(L,"class","svelte-1qv8711"),f(A,"id","brushOpacity"),f(A,"class","menu vert svelte-1qv8711"),N.value="2",f(N,"type","color"),f(N,"class","menu svelte-1qv8711"),f(N,"id","color"),f(e,"class","svelte-1qv8711")},m(r,h){o(r,e,h),a(e,i),a(i,n),K.m(n,null),a(i,s),a(i,p),t[22](p),m(p,t[0]),a(i,y),a(i,b),a(b,w),a(b,x),m(x,t[0]),a(i,k),a(i,_),m(_,t[5]),a(i,E),a(i,$),m($,t[4]),a(i,S),a(i,P),it.m(P,null),a(i,B),rt&&rt.m(i,null),t[27](i),a(e,F),a(e,I),a(I,C),a(e,M),a(e,A),a(A,L),a(e,G),a(e,N),a(e,O),D(U,e,null),a(e,H);for(let t=0;t<st.length;t+=1)st[t].m(e,null);a(e,W),D(Q,e,null),Z=!0,X||(V=[d(n,"click",t[18]),d(p,"change",t[23]),d(p,"input",t[23]),d(x,"input",t[24]),d(_,"input",t[19]),d(_,"change",t[25]),d(_,"input",t[25]),d($,"input",t[20]),d($,"input",t[26]),d(P,"click",t[17]),d(C,"change",t[14]),d(L,"change",t[13]),d(N,"change",t[15])],X=!0)},p(t,s){if(J!==(J=Y(t))&&(K.d(1),K=J(t),K&&(K.c(),K.m(n,null))),(!Z||16&s[0])&&f(p,"max",t[4]),1&s[0]&&m(p,t[0]),(!Z||16&s[0])&&f(x,"max",t[4]),1&s[0]&&g(x.value)!==t[0]&&m(x,t[0]),32&s[0]&&m(_,t[5]),16&s[0]&&g($.value)!==t[4]&&m($,t[4]),et!==(et=tt(t))&&(it.d(1),it=et(t),it&&(it.c(),it.m(P,null))),t[7]?rt?rt.p(t,s):(rt=wt(t),rt.c(),rt.m(i,null)):rt&&(rt.d(1),rt=null),2097664&s[0]){let i;for(nt=t[9],i=0;i<nt.length;i+=1){const r=gt(t,nt,i);st[i]?(st[i].p(r,s),z(st[i],1)):(st[i]=_t(r),st[i].c(),z(st[i],1),st[i].m(e,W))}for(T={r:0,c:[],p:T},i=nt.length;i<st.length;i+=1)at(i);T.r||r(T.c),T=T.p}Q.$set({})},i(t){if(!Z){z(U.$$.fragment,t);for(let t=0;t<nt.length;t+=1)z(st[t]);z(Q.$$.fragment,t),Z=!0}},o(t){j(U.$$.fragment,t),st=st.filter(Boolean);for(let t=0;t<st.length;t+=1)j(st[t]);j(Q.$$.fragment,t),Z=!1},d(i){i&&h(e),K.d(),t[22](null),it.d(),rt&&rt.d(),t[27](null),R(U),function(t,e){for(let i=0;i<t.length;i+=1)t[i]&&t[i].d(e)}(st,i),t[29](null),R(Q),X=!1,r(V)}}}!function t(e,i,r){function n(a,o){if(!i[a]){if(!e[a]){var h="function"==typeof require&&require;if(!o&&h)return h(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[a]={exports:{}};e[a][0].call(u.exports,(function(t){var i=e[a][1][t];return n(i||t)}),u,u.exports,t,e,i,r)}return i[a].exports}for(var s="function"==typeof require&&require,a=0;a<r.length;a++)n(r[a]);return n}({1:[function(t,e,i){var r=t("./TypedNeuQuant.js"),n=t("./LZWEncoder.js");function s(){this.page=-1,this.pages=[],this.newPage()}s.pageSize=4096,s.charMap={};for(var a=0;a<256;a++)s.charMap[a]=String.fromCharCode(a);function o(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new s}s.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(s.pageSize),this.cursor=0},s.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var i=0;i<s.pageSize;i++)t+=s.charMap[this.pages[e][i]];return t},s.prototype.writeByte=function(t){this.cursor>=s.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t},s.prototype.writeUTFBytes=function(t){for(var e=t.length,i=0;i<e;i++)this.writeByte(t.charCodeAt(i))},s.prototype.writeBytes=function(t,e,i){for(var r=i||t.length,n=e||0;n<r;n++)this.writeByte(t[n])},o.prototype.setDelay=function(t){this.delay=Math.round(t/10)},o.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)},o.prototype.setDispose=function(t){t>=0&&(this.dispose=t)},o.prototype.setRepeat=function(t){this.repeat=t},o.prototype.setTransparent=function(t){this.transparent=t},o.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},o.prototype.finish=function(){this.out.writeByte(59)},o.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t},o.prototype.setDither=function(t){!0===t&&(t="FloydSteinberg"),this.dither=t},o.prototype.setGlobalPalette=function(t){this.globalPalette=t},o.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},o.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},o.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new r(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/)):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},o.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var i=0,r=0;r<e;r++){var n=this.findClosestRGB(255&this.pixels[i++],255&this.pixels[i++],255&this.pixels[i++]);this.usedEntry[n]=!0,this.indexedPixels[r]=n}},o.prototype.ditherPixels=function(t,e){var i={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!t||!i[t])throw"Unknown dithering kernel: "+t;var r=i[t],n=0,s=this.height,a=this.width,o=this.pixels,h=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var l=0;l<s;l++){e&&(h*=-1);for(var u=1==h?0:a-1,c=1==h?a:0;u!==c;u+=h){var d=3*(n=l*a+u),p=o[d],f=o[d+1],g=o[d+2];d=this.findClosestRGB(p,f,g),this.usedEntry[d]=!0,this.indexedPixels[n]=d,d*=3;for(var m=p-this.colorTab[d],v=f-this.colorTab[d+1],y=g-this.colorTab[d+2],b=1==h?0:r.length-1,w=1==h?r.length:0;b!==w;b+=h){var x=r[b][1],k=r[b][2];if(x+u>=0&&x+u<a&&k+l>=0&&k+l<s){var _=r[b][0];d=n+x+k*a,o[d*=3]=Math.max(0,Math.min(255,o[d]+m*_)),o[d+1]=Math.max(0,Math.min(255,o[d+1]+v*_)),o[d+2]=Math.max(0,Math.min(255,o[d+2]+y*_))}}}}},o.prototype.findClosest=function(t,e){return this.findClosestRGB((16711680&t)>>16,(65280&t)>>8,255&t,e)},o.prototype.findClosestRGB=function(t,e,i,r){if(null===this.colorTab)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(t,e,i);for(var n=0,s=16777216,a=this.colorTab.length,o=0,h=0;o<a;h++){var l=t-(255&this.colorTab[o++]),u=e-(255&this.colorTab[o++]),c=i-(255&this.colorTab[o++]),d=l*l+u*u+c*c;(!r||this.usedEntry[h])&&d<s&&(s=d,n=h)}return n},o.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var i=this.image,r=0,n=0,s=0;s<e;s++)for(var a=0;a<t;a++)this.pixels[n++]=i[r++],this.pixels[n++]=i[r++],this.pixels[n++]=i[r++],r++},o.prototype.writeGraphicCtrlExt=function(){var t,e;this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4),null===this.transparent?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=7&dispose),e<<=2,this.out.writeByte(0|e|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},o.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},o.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},o.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},o.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=768-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)},o.prototype.writeShort=function(t){this.out.writeByte(255&t),this.out.writeByte(t>>8&255)},o.prototype.writePixels=function(){new n(this.width,this.height,this.indexedPixels,this.colorDepth).encode(this.out)},o.prototype.stream=function(){return this.out},e.exports=o},{"./LZWEncoder.js":2,"./TypedNeuQuant.js":3}],2:[function(t,e,i){var r=5003,n=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];e.exports=function(t,e,i,s){var a,o,h,l,u,c,d=Math.max(2,s),p=new Uint8Array(256),f=new Int32Array(r),g=new Int32Array(r),m=0,v=0,y=!1;function b(t,e){p[o++]=t,o>=254&&k(e)}function w(t){x(r),v=u+2,y=!0,$(u,t)}function x(t){for(var e=0;e<t;++e)f[e]=-1}function k(t){o>0&&(t.writeByte(o),t.writeBytes(p,0,o),o=0)}function _(t){return(1<<t)-1}function E(){return 0===remaining?-1:(--remaining,255&i[curPixel++])}function $(t,e){for(a&=n[m],m>0?a|=t<<m:a=t,m+=n_bits;m>=8;)b(255&a,e),a>>=8,m-=8;if((v>h||y)&&(y?(h=_(n_bits=l),y=!1):(++n_bits,h=12==n_bits?4096:_(n_bits))),t==c){for(;m>0;)b(255&a,e),a>>=8,m-=8;k(e)}}this.encode=function(i){i.writeByte(d),remaining=t*e,curPixel=0,function(t,e){var i,n,s,a,d,p,m;for(l=t,y=!1,n_bits=l,h=_(n_bits),c=1+(u=1<<t-1),v=u+2,o=0,a=E(),m=0,i=r;i<65536;i*=2)++m;m=8-m,x(p=r),$(u,e);t:for(;-1!=(n=E());)if(i=(n<<12)+a,f[s=n<<m^a]!==i){if(f[s]>=0){d=p-s,0===s&&(d=1);do{if((s-=d)<0&&(s+=p),f[s]===i){a=g[s];continue t}}while(f[s]>=0)}$(a,e),a=n,v<4096?(g[s]=v++,f[s]=i):w(e)}else a=g[s];$(a,e),$(c,e)}(d+1,i),i.writeByte(0)}}},{}],3:[function(t,e,i){var r=256,n=1024,s=1<<18;e.exports=function(t,e){var i,a,o,h,l;function u(t,e,r,s,a){i[e][0]-=t*(i[e][0]-r)/n,i[e][1]-=t*(i[e][1]-s)/n,i[e][2]-=t*(i[e][2]-a)/n}function c(t,e,n,a,o){for(var h,u,c=Math.abs(e-t),d=Math.min(e+t,r),p=e+1,f=e-1,g=1;p<d||f>c;)u=l[g++],p<d&&((h=i[p++])[0]-=u*(h[0]-n)/s,h[1]-=u*(h[1]-a)/s,h[2]-=u*(h[2]-o)/s),f>c&&((h=i[f--])[0]-=u*(h[0]-n)/s,h[1]-=u*(h[1]-a)/s,h[2]-=u*(h[2]-o)/s)}function d(t,e,n){var s,a,l,u,c,d=~(1<<31),p=d,f=-1,g=f;for(s=0;s<r;s++)a=i[s],(l=Math.abs(a[0]-t)+Math.abs(a[1]-e)+Math.abs(a[2]-n))<d&&(d=l,f=s),(u=l-(o[s]>>12))<p&&(p=u,g=s),c=h[s]>>10,h[s]-=c,o[s]+=c<<10;return h[f]+=64,o[f]-=65536,g}this.buildColormap=function(){!function(){var t,e;for(i=[],a=new Int32Array(256),o=new Int32Array(r),h=new Int32Array(r),l=new Int32Array(32),t=0;t<r;t++)e=(t<<12)/r,i[t]=new Float64Array([e,e,e,0]),h[t]=256,o[t]=0}(),function(){var i,r,s,a,o,h,p=t.length,f=30+(e-1)/3,g=p/(3*e),m=~~(g/100),v=n,y=2048,b=y>>6;for(b<=1&&(b=0),i=0;i<b;i++)l[i]=v*(256*(b*b-i*i)/(b*b));p<1509?(e=1,r=3):r=p%499!=0?1497:p%491!=0?1473:p%487!=0?1461:1509;var w=0;for(i=0;i<g;)if(u(v,h=d(s=(255&t[w])<<4,a=(255&t[w+1])<<4,o=(255&t[w+2])<<4),s,a,o),0!==b&&c(b,h,s,a,o),(w+=r)>=p&&(w-=p),0===m&&(m=1),++i%m==0)for(v-=v/f,(b=(y-=y/30)>>6)<=1&&(b=0),h=0;h<b;h++)l[h]=v*(256*(b*b-h*h)/(b*b))}(),function(){for(var t=0;t<r;t++)i[t][0]>>=4,i[t][1]>>=4,i[t][2]>>=4,i[t][3]=t}(),function(){var t,e,n,s,o,h,l=0,u=0;for(t=0;t<r;t++){for(o=t,h=(n=i[t])[1],e=t+1;e<r;e++)(s=i[e])[1]<h&&(o=e,h=s[1]);if(s=i[o],t!=o&&(e=s[0],s[0]=n[0],n[0]=e,e=s[1],s[1]=n[1],n[1]=e,e=s[2],s[2]=n[2],n[2]=e,e=s[3],s[3]=n[3],n[3]=e),h!=l){for(a[l]=u+t>>1,e=l+1;e<h;e++)a[e]=t;l=h,u=t}}for(a[l]=u+255>>1,e=l+1;e<256;e++)a[e]=255}()},this.getColormap=function(){for(var t=[],e=[],n=0;n<r;n++)e[i[n][3]]=n;for(var s=0,a=0;a<r;a++){var o=e[a];t[s++]=i[o][0],t[s++]=i[o][1],t[s++]=i[o][2]}return t},this.lookupRGB=function(t,e,n){for(var s,o,h,l=1e3,u=-1,c=a[e],d=c-1;c<r||d>=0;)c<r&&((h=(o=i[c])[1]-e)>=l?c=r:(c++,h<0&&(h=-h),(s=o[0]-t)<0&&(s=-s),(h+=s)<l&&((s=o[2]-n)<0&&(s=-s),(h+=s)<l&&(l=h,u=o[3])))),d>=0&&((h=e-(o=i[d])[1])>=l?d=-1:(d--,h<0&&(h=-h),(s=o[0]-t)<0&&(s=-s),(h+=s)<l&&((s=o[2]-n)<0&&(s=-s),(h+=s)<l&&(l=h,u=o[3]))));return u}}},{}],4:[function(t,e,i){var r,n;r=t("./GIFEncoder.js"),n=function(t){var e,i,n,s;return e=new r(t.width,t.height),0===t.index?e.writeHeader():e.firstFrame=!1,e.setTransparent(t.transparent),e.setRepeat(t.repeat),e.setDelay(t.delay),e.setQuality(t.quality),e.setDither(t.dither),e.setGlobalPalette(t.globalPalette),e.addFrame(t.data),t.last&&e.finish(),!0===t.globalPalette&&(t.globalPalette=e.getGlobalPalette()),n=e.stream(),t.data=n.pages,t.cursor=n.cursor,t.pageSize=n.constructor.pageSize,t.canTransfer?(s=function(){var e,r,n,s;for(s=[],e=0,r=(n=t.data).length;e<r;e++)i=n[e],s.push(i.buffer);return s}(),self.postMessage(t,s)):self.postMessage(t)},self.onmessage=function(t){return n(t.data)}},{"./GIFEncoder.js":1}]},{},[4]);function $t(){}function St(t){}function Pt(t,e,i){let r,n,s,a=!0,o=10,h=0,l=1,u=0,c=!1,d=!1,p=[null];function f(t){u<=l?u++:u=0,i(9,p[0].currentPoint=t.detail,p)}function m(){i(6,c=!c),c&&v()}function v(){c&&(h<o?i(0,h++,h):i(0,h=0),setTimeout((()=>{requestAnimationFrame(v)}),100))}return x((()=>{i(2,n.style.left=window.innerWidth/2-parseInt(window.getComputedStyle(n).width)/2+"px",n),i(7,d=p[0].recording),i(0,h=1),i(4,o=p[0].frameEnd),i(5,l=p[0].frameSkip),addEventListener("keyup",(t=>{32==t.which&&m()}))})),t.$$.update=()=>{1&t.$$.dirty[0]&&h&&(i(9,p[0].frameIdx=h,p),d&&p[0].endStroke())},[h,r,n,a,o,l,c,d,s,p,f,function(){p[0].endStroke(),a&&i(0,h=0)},function(t){switch(t.detail.type){case"png":p[0].savePNG();break;case"gif":p[0].saveGIF()}},function(t){i(9,p[0].opacity=t.target.value,p)},function(t){i(9,p[0].iSize=t.target.value/2,p)},function(t){i(9,p[0].color=t.target.value,p)},function(){i(3,a=!a)},function(){i(7,d=!d),i(9,p[0].recording=d,p)},m,function(t){i(9,p[0].frameSkip=t.target.value,p)},function(t){i(9,p[0].frameEnd=t.target.value,p)},function(t){u==l&&(h<o?(i(0,h++,h),f(t)):i(0,h=0))},function(t){$[t?"unshift":"push"]((()=>{s=t,i(8,s)}))},function(){h=g(this.value),i(0,h)},function(){h=g(this.value),i(0,h)},function(){l=g(this.value),i(5,l)},function(){o=g(this.value),i(4,o)},function(t){$[t?"unshift":"push"]((()=>{n=t,i(2,n)}))},function(t,e,r){$[t?"unshift":"push"]((()=>{e[r]=t,i(9,p)}))},function(t){$[t?"unshift":"push"]((()=>{r=t,i(1,r)}))}]}return new class extends U{constructor(t){super(),O(this,t,Pt,Et,s,{},null,[-1,-1])}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
